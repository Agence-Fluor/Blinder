# Message Security Algorithm

## Basic Message Security Protocol

Alice and Bob establish secure communication through a multi-layered cryptographic protocol. Initially, Alice generates an ED25519 identity key pair (id_sk, id_pk) for authentication and signs her X25519 messaging public key (msg_pk) with her identity private key, publishing both to the server. When Bob wants to send a message to Alice, he retrieves her signed msg_pk, verifies the ED25519 signature to ensure authenticity, then performs an X25519 key exchange to derive a shared secret. This shared secret is used to establish a session key for message encryption, implementing Forward Confidentiality Security (FCS) by rotating session keys periodicallyâ€”if Hector compromises a current session key, he cannot decrypt past messages. To achieve Post-Compromise Security (PCS), Alice and Bob perform periodic re-keying operations using X25519: if Hector compromises a session key at time T, future messages after a re-keying event at time T+1 remain secure. For match discovery and private set intersection (PSI) operations, Alice encrypts her preferences using her TFHE public key (fhe_pk), allowing the server to homomorphically evaluate matching circuits without learning her choices; Bob's preferences are similarly encrypted, and the server returns encrypted match results that only Alice and Bob can decrypt with their respective TFHE secret keys, ensuring Hector cannot learn either party's preferences even if he compromises the server.

